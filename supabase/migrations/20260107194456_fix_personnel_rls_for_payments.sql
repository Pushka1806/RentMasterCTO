/*
  # Исправление RLS политик для таблицы personnel
  
  1. Изменения
    - Удаление старой ограничительной политики SELECT для personnel
    - Создание новой политики, позволяющей всем аутентифицированным пользователям просматривать всех работников
    - Это необходимо для корректной работы страницы выплат, которая делает джойн с таблицей personnel
  
  2. Безопасность
    - Просмотр: Все аутентифицированные пользователи могут видеть всех работников
    - Создание/Изменение/Удаление: Только владелец записи (user_id = auth.uid())
*/

-- Удаляем старую ограничительную политику
DROP POLICY IF EXISTS "Users can view own personnel" ON personnel;

-- Создаем новую политику для просмотра всех работников аутентифицированными пользователями
CREATE POLICY "Authenticated users can view all personnel"
  ON personnel
  FOR SELECT
  TO authenticated
  USING (true);
